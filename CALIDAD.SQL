-- Active: 1662052389079@@148.230.13.152@1521@orcl@ISTI422


-- BUSQUEDA DE DUPLICADOS
SELECT ID_ORDEN, ID_CLIENTE, ID_ESTADO, ID_PRODUCTO, COUNT(*) FROM EST_ORDENES
GROUP BY ID_ORDEN, ID_CLIENTE, ID_ESTADO, ID_PRODUCTO
HAVING COUNT(*)>1;

    -- CADA UNA DE LAS ORDENES DUPLICADAS
    SELECT A.* FROM EST_ORDENES A,
    (SELECT ID_ORDEN, ID_CLIENTE, ID_ESTADO, ID_PRODUCTO, ID_TIEMPO FROM EST_ORDENES GROUP BY ID_ORDEN, ID_CLIENTE, ID_ESTADO, ID_PRODUCTO, ID_TIEMPO HAVING COUNT(*) > 1) B
    WHERE A.ID_ORDEN = B.ID_ORDEN
        AND A.ID_PRODUCTO = B.ID_PRODUCTO
        AND A.ID_ESTADO = B.ID_ESTADO
        AND A.ID_CLIENTE = B.ID_CLIENTE
        AND A.ID_TIEMPO = B.ID_TIEMPO
    ORDER BY A.ID_ORDEN;

-- BUSQUEDA DE ORDENES CON PRODUCTOS INEXISTENTES
SELECT DISTINCT ID_PRODUCTO FROM EST_ORDENES WHERE ID_PRODUCTO NOT IN (SELECT ID_PRODUCTO FROM EST_PRODUCTO);
        -- COMPOROBACION
            SELECT ID_PRODUCTO, COUNT(*) FROM EST_ORDENES WHERE ID_PRODUCTO = 1201201 GROUP BY ID_PRODUCTO;
            SELECT * FROM EST_PRODUCTO WHERE ID_PRODUCTO = 1201201 ;
        
        -- OPUESTO
        SELECT DISTINCT ID_PRODUCTO FROM EST_PRODUCTO WHERE ID_PRODUCTO NOT IN (SELECT ID_PRODUCTO FROM EST_ORDENES);

SELECT DISTINCT ID_CLIENTE FROM EST_ORDENES WHERE ID_CLIENTE NOT IN (SELECT ID_CLIENTE FROM CLIENTE);
            -- COMPROBACION
            SELECT * FROM EST_CLIENTE WHERE ID_CLIENTE = 50148227;
            SELECT ID_CLIENTE, COUNT(*) FROM EST_ORDENES WHERE ID_CLIENTE = 50148227 GROUP BY ID_CLIENTE;
            SELECT ID_CLIENTE, ID_ORDEN, COUNT(*) FROM EST_ORDENES WHERE ID_CLIENTE = 50148227 GROUP BY ID_CLIENTE, ID_ORDEN;
            
    -- OPUESTO
    SELECT DISTINCT ID_CLIENTE FROM EST_CLIENTE WHERE ID_CLIENTE NOT IN (SELECT ID_CLIENTE FROM EST_ORDENES);