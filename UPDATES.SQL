-- Active: 1662052389079@@148.230.13.152@1521@orcl@ISTI422

-- 1. CAMBIO DEL PRODUCTO REPETIDO 
    -- AGREGAR ID POR ELIMINAR EN COLUMNA DE ORIGINALES
    UPDATE EST_ORDENES
    SET ID_PRODUCTO = 1273443
    WHERE ID_PRODUCTO = 1273443;

DELETE FROM EST_PRODUCTO WHERE ID_PRODUCTO = 1273443;
    -- SUSTITUIR ID_PRODUCTO ELIMINADO POR EL QUE SE DEJO
    -- SELECT * FROM EST_ORDENES WHERE ID_PRODUCTO = 1273443;
    --Existen 185
    UPDATE EST_ORDENES
    SET ID_PRODUCTO = 1200188
    WHERE ID_PRODUCTO = 1273443;

-- 2. CORREGIR ERROR EN CATEGORIA
UPDATE EST_PRODUCTO
SET CATEGORIA = REGEXP_REPLACE(CATEGORIA, 'Infatil', 'Infantil' );

-- 3. EN LA COLUMNA PRESENTACION, ELIMINAR PARENTESIS
UPDATE EST_PRODUCTO
SET PRESENTACION = REGEXP_REPLACE(PRESENTACION, '\(|\)', '' );

-- 4. COLUMNA VARIANTE
    -- Eliminar Espacios Al principio y al final
    UPDATE EST_PRODUCTO
    SET VARIANTE = TRIM(VARIANTE);

    -- CAMBIAR PREM POR PREMIUM
    -- SELECT VARIANTE, TRIM(REGEXP_REPLACE(VARIANTE, 'PREM(\s|$)', 'PREMIUM ' ) )FROM EST_PRODUCTO WHERE REGEXP_LIKE(VARIANTE, 'PREM');
    UPDATE EST_PRODUCTO
    SET VARIANTE =  TRIM(REGEXP_REPLACE(VARIANTE, 'PREM(\s|$)', 'PREMIUM ' ) );

    -- CAMBIAR CNFRT POR CONFORT
    -- SELECT VARIANTE, TRIM(REGEXP_REPLACE(VARIANTE, 'CONFRT', 'CONFORT' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(VARIANTE, 'CONFRT');
    UPDATE EST_PRODUCTO
    SET VARIANTE =  TRIM(REGEXP_REPLACE(VARIANTE, 'CONFRT', 'CONFORT' ) );

    -- CAMBIAR LACFREE POR LACTOFREE
    -- SELECT VARIANTE, TRIM(REGEXP_REPLACE(VARIANTE, 'LACFREE', 'LACTOFREE' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(VARIANTE, 'LACFREE');
    UPDATE EST_PRODUCTO
    SET VARIANTE =  TRIM(REGEXP_REPLACE(VARIANTE, 'LACFREE', 'LACTOFREE' ) );

    -- CAMBIAR PWDCHOC POR POWDER CHOC
    -- SELECT VARIANTE, TRIM(REGEXP_REPLACE(VARIANTE, 'PWDCHOC', 'POWDER CHOC' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(VARIANTE, 'PWDCHOC');
    UPDATE EST_PRODUCTO
    SET VARIANTE =  TRIM(REGEXP_REPLACE(VARIANTE, 'PWDCHOC', 'POWDER CHOC' ) );

    -- PWD POR POWDER
    -- SELECT VARIANTE, TRIM(REGEXP_REPLACE(VARIANTE, 'PWD', 'POWDER' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(VARIANTE, 'PWD');
    UPDATE EST_PRODUCTO
    SET VARIANTE =  TRIM(REGEXP_REPLACE(VARIANTE, 'PWD', 'POWDER' ) );

    -- CHOC+STW POR CHOC STW
    -- SELECT VARIANTE, TRIM(REGEXP_REPLACE(VARIANTE, 'CHOC\+STW', 'CHOC STW' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(VARIANTE, 'CHOC\+STW');
    UPDATE EST_PRODUCTO
    SET VARIANTE =  TRIM(REGEXP_REPLACE(VARIANTE, 'CHOC\+STW', 'CHOC STW' ) );

-- 5. COLUMNA MARCA
    -- VITAMINATE POR VITAMINA-TE
    -- SELECT MARCA, TRIM(REGEXP_REPLACE(MARCA, 'VITAMINATE', 'VITAMINA-TE' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(MARCA, 'VITAMINATE');
    UPDATE EST_PRODUCTO
    SET MARCA =  TRIM(REGEXP_REPLACE(MARCA, 'VITAMINATE', 'VITAMINA-TE' ));

    --PREM A PREMIUM
    UPDATE EST_PRODUCTO
    SET MARCA =  TRIM(REGEXP_REPLACE(MARCA, 'PREM(\s|$)', 'PREMIUM ' ) );

    -- CNTG PREMIUM 3
    -- SELECT MARCA, TRIM(REGEXP_REPLACE(MARCA, '(CNTG PREMIUM3)|(CNTGPREM3)|(CNTGPREMIUM3)', 'CNTG PREMIUM 3' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(MARCA, '(CNTG PREMIUM3)|(CNTGPREM3)|(CNTGPREMIUM3)');

    UPDATE EST_PRODUCTO
    SET MARCA =  TRIM(REGEXP_REPLACE(MARCA, '(CNTG PREMIUM3)|(CNTGPREM3)|(CNTGPREMIUM3)', 'CNTG PREMIUM 3' ) );

    -- CHOCO LECHE POR CHOCOLECHE
    -- SELECT MARCA, TRIM(REGEXP_REPLACE(MARCA, '(CH|CHOCO) LECHE', 'CHOCOLECHE' ) ) FROM EST_PRODUCTO WHERE REGEXP_LIKE(MARCA, '(CH|CHOCO) LECHE');
    UPDATE EST_PRODUCTO
    SET MARCA =TRIM(REGEXP_REPLACE(MARCA, '(CH|CHOCO) LECHE', 'CHOCOLECHE' ));


SELECT * FROM EST_PRODUCTO;

COMMIT;